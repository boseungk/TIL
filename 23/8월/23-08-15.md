## 동시성 문제

동시성 문제는 지역 변수에서는 발생하지 않는다. 지역 변수는 쓰레드마다 별도의 저장공간을 갖기 때문이다. 반면에 인스턴스 변수(싱글톤)이나 클래스 변수 같은 공용 필드에 접근할 때 문제가 생긴다.

동시성 문제는 값을 읽기만 한다면 발생하지 않는다. 어디선가 값을 수정하기 때문에 발생한다.

이런 문제를 해결하기 위해서 자바에서는 `ThreadLocal` 클래스를 제공한다.

**ThreadLocal 사용법**

* 값 저장: ThreadLocal.set(xxx)
* 값 조회: ThreadLocal.get()
* 값 제거: ThreadLocal.remove()

ThreadLocal을 다 사용하고나서 꼭 `ThreaLocal.remove()`를 호출해서 쓰레드 로컬에 저장된 값을 제거해주어야 한다.

그렇지 않으면 쓰레드 풀을 사용하는 다른 프로그램에서 해당 쓰레드 저장소에 있는 데이터를 그대로 사용해서 문제가 발생할 수 있다!

## 추상 클래스와 인터페이스

추상 클래스랑 인터페이스는 둘 다 구현을 강제한다는 점에서 비슷해서 언제 사용하는걸까라는 생각이 들어서 차이점을 살펴보았다.

먼저 추상 클래스는 `상속`과 `확장`이 핵심이다.

추상 클래스는 `extends`라는 예약어를 통해 하위 클래스에서 구현된다. 

자바의 상속 특성 상 단일 상속만 가능하고 같은 부모 클래스를 가진 자식 클래스라는 의미를 전달한다는 것을 알 수 있다.

반면에 인터페이스는 `구현`이 핵심이다.

먼저 인터페이스는 `static final` 필드만 가지고 있다.

이를 통해 인터페이스는 하위 클래스들이 **같은 기능을 보장**하기 위해서 위와 같이 모든 필드들이 `static final`로 선언되어있다는 것을 알 수 있다.(`implements`라는 예약어를 통해서도 추론해볼 수 있다.)

그리고 인터페이스는 인터페이스끼리 다중 상속이 가능하고 구현도 다중 인터페이스로 가능하다.

```java
public interface FlyFish extends ISwim, IFly {
//...
}
```

```java
class 날치 implements ISwim, IFly {
//...
}
```

자바 8 이전에는 인터페이스에서 구현 메서드를 가지는 것이 불가능해서 구현 메서드를 가질 수 있는 지 여부로 추상 클래스와 인터페이스의 쓰임을 나누어 볼 수도 있었다.

하지만 자바 8 이후에 인터페이스에 `default` 예약어를 통해 구현 메서드를 가지는 것이 가능해져서 이제는 큰 의미는 없는 것 같다.
## 스트림 vs for loop 성능

</br>

![for loop](https://github.com/boseungk/TIL/assets/95980754/4449b6ed-f3e7-4de5-8267-2072c5b7d720)

</br>

![stream](https://github.com/boseungk/TIL/assets/95980754/45ea6622-f0b4-41f9-868f-11f463b6e5c6)

</br>

스트림을 연습하면서 기존의 for loop문이랑 비교를 해보니까 생각보다 많이 느렸다.

대충 봐도 해당 문제에서 200~300배 정도 느린데, 언제 반복문을 사용하고 스트림을 사용해야 효율적인지 알아야 할 것 같다.

</br>

-----

</br>

지민님이 공유해주신 스터디 글을 참고하고, 여러 글들을 읽어보면서 대략적으로 언제 for loop를 쓰고 스트림을 써야 하는지 알 수 있었다.

일단 스트림을 써야 하는 이유는 퍼포먼스만이 성능을 측정하는 유일한 지표가 아니기 때문이다. 

모든 것은 trade-off 이기 때문에 일반적으로 성능이 좋은 코드는 가독성이 좋지 않고, 가독성이 좋은 코드는 성능이 좋지 않기 마련이다.

요즘에는 유지보수 비용이 하드웨어 비용보다 훨씬 높기 때문에 일반적으로 가독성/유지보수가 가능한 코드가 더 유리하다고 한다. 

따라서 **millisecond** 정도로 성능이 중요한 이슈가 아니라면(특히 전체 기술 스택과 소프트웨어가 최적화되지 않은 상태라면) ***millisecond*** 정도의 성능 이슈는 그렇게 중요하지 않다고 한다. ([Java streams vs for loop](https://blog.jdriven.com/2019/10/loop/))

이외에도 원시타입을 사용할 때에는 for loop가 유리하지만, ArrayList와 같이 힙(heap) 영역의 값을 참조해서 사용하는 경우에는 스트림과 크게 차이 나지 않는다고 한다.

스트림을 사용할 때 유의할 점으로는 boxing이나 unboxing의 경우 for loop와 비교해서 특히 힙(heap) 리소스를 많이 잡아먹기 때문에 성능을 고려할 때에는 주의해야 한다.

또 병렬 처리(parallel stream)을 사용할 때, 병렬 처리 시 발생하는 오버헤드 비용과  동시성 이슈가 발생할 수 있기 때문에 특히 유의해야 한다.